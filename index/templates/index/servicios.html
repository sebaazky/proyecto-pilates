{% extends 'index/base_index.html' %}
{% block title %}Servicios | PilatesReserva{% endblock %}

{% block extra_head %}
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,700&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --sv-ink:    #0a0a0f;
    --sv-cream:  #faf8f4;
    --sv-gold:   #c9a84c;
    --sv-cyan:   #12b3ff;
    --sv-violet: #7c3aed;
    --sv-mist:   #f0ede8;
    --sv-border: #e8e2d8;
  }
  [data-theme="dark"] {
    --sv-ink:    #f0ede8;
    --sv-cream:  #0d0d14;
    --sv-mist:   #14141f;
    --sv-border: #1e2030;
  }

  .sv-display {
    font-family: 'Playfair Display', Georgia, serif;
    font-weight: 900;
    line-height: .95;
    letter-spacing: -.02em;
  }
  .sv-label {
    font-family: 'DM Sans', sans-serif;
    font-size: .7rem;
    font-weight: 500;
    letter-spacing: .18em;
    text-transform: uppercase;
    color: var(--sv-gold);
  }

  /* ── HERO ─────────────────────────────────────── */
  .sv-hero {
    background: var(--sv-ink);
    color: #fff;
    padding: clamp(4rem, 10vh, 7rem) 0 clamp(3rem, 6vh, 5rem);
    position: relative;
    overflow: hidden;
  }
  .sv-hero::before {
    content: '';
    position: absolute; inset: 0;
    background:
      radial-gradient(ellipse 55% 60% at 0% 100%, rgba(124,58,237,.3), transparent 60%),
      radial-gradient(ellipse 45% 50% at 100% 0%, rgba(18,179,255,.18), transparent 55%);
  }
  .sv-hero-bg-text {
    position: absolute;
    right: -2rem; bottom: -2rem;
    font-family: 'Playfair Display', serif;
    font-size: clamp(8rem, 20vw, 16rem);
    font-weight: 900;
    color: rgba(255,255,255,.03);
    line-height: 1;
    pointer-events: none;
    user-select: none;
  }

  /* ── LAYOUT PRINCIPAL ─────────────────────────── */
  .sv-layout {
    display: grid;
    grid-template-columns: 280px 1fr;
    gap: 3rem;
    align-items: start;
    padding: 3rem 0 5rem;
  }
  @media (max-width: 900px) {
    .sv-layout { grid-template-columns: 1fr; gap: 2rem; }
  }

  /* ── SIDEBAR (sublista) ───────────────────────── */
  .sv-sidebar {
    position: sticky;
    top: 100px;
  }
  .sv-sidebar-title {
    font-family: 'DM Sans', sans-serif;
    font-size: .7rem;
    font-weight: 600;
    letter-spacing: .18em;
    text-transform: uppercase;
    color: var(--sv-gold);
    margin-bottom: 1rem;
    padding-bottom: .75rem;
    border-bottom: 2px solid var(--sv-gold);
    display: inline-block;
  }
  .sv-nav {
    list-style: none;
    padding: 0; margin: 0;
    display: flex;
    flex-direction: column;
    gap: .3rem;
  }
  .sv-nav-item a {
    display: flex;
    align-items: center;
    gap: .75rem;
    padding: .75rem 1rem;
    border-radius: 12px;
    text-decoration: none;
    font-family: 'DM Sans', sans-serif;
    font-size: .9rem;
    font-weight: 500;
    color: var(--sv-ink);
    border: 1.5px solid transparent;
    transition: all .2s ease;
    background: transparent;
  }
  .sv-nav-item a:hover,
  .sv-nav-item a.active {
    background: var(--sv-cream);
    border-color: var(--sv-border);
    color: var(--sv-cyan);
    box-shadow: 0 4px 12px rgba(18,179,255,.08);
    transform: translateX(4px);
  }
  .sv-nav-item a .sv-nav-dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    background: var(--sv-border);
    flex-shrink: 0;
    transition: background .2s;
  }
  .sv-nav-item a:hover .sv-nav-dot,
  .sv-nav-item a.active .sv-nav-dot {
    background: var(--sv-cyan);
  }
  .sv-nav-num {
    margin-left: auto;
    font-size: .72rem;
    font-weight: 600;
    color: var(--sv-gold);
    background: rgba(201,168,76,.1);
    border-radius: 999px;
    padding: .1rem .5rem;
  }

  /* ── TARJETAS DE SERVICIO ─────────────────────── */
  .sv-card {
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-radius: 24px;
    overflow: hidden;
    border: 1.5px solid var(--sv-border);
    background: var(--sv-cream);
    scroll-margin-top: 110px;
    transition: box-shadow .3s ease, transform .3s ease;
    margin-bottom: 2rem;
  }
  .sv-card:hover {
    box-shadow: 0 24px 48px rgba(18,179,255,.1);
    transform: translateY(-4px);
  }
  @media (max-width: 700px) {
    .sv-card { grid-template-columns: 1fr; }
  }
  .sv-card:nth-child(even) .sv-card-img { order: 2; }
  .sv-card:nth-child(even) .sv-card-body { order: 1; }
  @media (max-width: 700px) {
    .sv-card:nth-child(even) .sv-card-img { order: 0; }
    .sv-card:nth-child(even) .sv-card-body { order: 0; }
  }

  .sv-card-img {
    position: relative;
    min-height: 280px;
    overflow: hidden;
  }
  .sv-card-img img {
    width: 100%; height: 100%;
    object-fit: cover;
    display: block;
    transition: transform .6s ease, filter .4s ease;
    filter: grayscale(20%);
  }
  .sv-card:hover .sv-card-img img {
    transform: scale(1.06);
    filter: grayscale(0%);
  }
  .sv-card-img-fallback {
    width: 100%; height: 100%; min-height: 280px;
    display: flex; align-items: center; justify-content: center;
    background: linear-gradient(135deg, rgba(18,179,255,.08), rgba(124,58,237,.08));
    font-size: 4rem;
    color: rgba(18,179,255,.3);
  }
  .sv-card-num {
    position: absolute;
    top: 1rem; left: 1rem;
    font-family: 'Playfair Display', serif;
    font-size: 3.5rem;
    font-weight: 900;
    color: rgba(255,255,255,.25);
    line-height: 1;
    pointer-events: none;
  }
  .sv-card-body {
    padding: 2.5rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  .sv-card-index {
    font-family: 'DM Sans', sans-serif;
    font-size: .7rem;
    font-weight: 600;
    letter-spacing: .2em;
    text-transform: uppercase;
    color: var(--sv-gold);
    margin-bottom: .75rem;
  }
  .sv-card-title {
    font-family: 'Playfair Display', serif;
    font-size: clamp(1.4rem, 2.5vw, 1.9rem);
    font-weight: 700;
    color: var(--sv-ink);
    margin-bottom: 1rem;
    line-height: 1.2;
  }
  .sv-card-desc {
    font-family: 'DM Sans', sans-serif;
    font-size: .95rem;
    line-height: 1.75;
    color: #6b6b80;
    flex-grow: 1;
    margin-bottom: 1.5rem;
  }
  [data-theme="dark"] .sv-card-desc { color: #9a9ab0; }
  .sv-card-price {
    font-family: 'Playfair Display', serif;
    font-size: 1.6rem;
    font-weight: 700;
    color: var(--sv-cyan);
    margin-bottom: 1.5rem;
    display: flex;
    align-items: baseline;
    gap: .35rem;
  }
  .sv-card-price small {
    font-family: 'DM Sans', sans-serif;
    font-size: .8rem;
    font-weight: 400;
    color: #9a9ab0;
  }
  .sv-card-btn {
    display: inline-flex;
    align-items: center;
    gap: .5rem;
    padding: .75rem 1.8rem;
    border-radius: 999px;
    background: var(--sv-ink);
    color: #fff;
    font-family: 'DM Sans', sans-serif;
    font-weight: 600;
    font-size: .88rem;
    letter-spacing: .04em;
    text-decoration: none;
    border: 2px solid var(--sv-ink);
    transition: all .25s ease;
    align-self: flex-start;
  }
  .sv-card-btn:hover {
    background: var(--sv-cyan);
    border-color: var(--sv-cyan);
    color: #fff;
    box-shadow: 0 8px 20px rgba(18,179,255,.3);
    transform: translateX(3px);
  }

  /* ── VACÍO ────────────────────────────────────── */
  .sv-empty {
    text-align: center;
    padding: 5rem 2rem;
    border-radius: 24px;
    border: 2px dashed var(--sv-border);
  }

  /* ── CTA ──────────────────────────────────────── */
  .sv-cta {
    background: var(--sv-gold);
    border-radius: 24px;
    padding: 3rem;
    position: relative;
    overflow: hidden;
  }
  .sv-cta::before {
    content: '?';
    font-family: 'Playfair Display', serif;
    font-size: 12rem;
    font-weight: 900;
    position: absolute;
    right: -1rem; top: -2rem;
    color: rgba(10,10,15,.06);
    line-height: 1;
    pointer-events: none;
  }

  /* ── REVEAL ───────────────────────────────────── */
  .sv-reveal {
    opacity: 0;
    transform: translateY(24px);
    transition: opacity .6s ease, transform .6s ease;
  }
  .sv-reveal.sv-in { opacity: 1; transform: none; }
  .sv-reveal-d1 { transition-delay: .1s; }
  .sv-reveal-d2 { transition-delay: .2s; }
</style>
{% endblock %}

{% block content %}

<!-- ═══════════════ HERO ══════════════════════════ -->
<section class="sv-hero">
  <div class="container" style="position:relative;z-index:1;">
    <p class="sv-label mb-3">Lo que ofrecemos</p>
    <h1 class="sv-display text-white mb-4"
        style="font-size:clamp(2.8rem,6vw,5rem);">
      Nuestros<br>
      <em style="color:var(--sv-gold);">servicios</em>
    </h1>
    <p style="font-family:'DM Sans',sans-serif;color:rgba(255,255,255,.6);
              font-size:1.05rem;max-width:520px;line-height:1.75;">
      Cada servicio está diseñado para tu bienestar real.
      Selecciona el que más se adapta a tus objetivos.
    </p>
  </div>
  <span class="sv-hero-bg-text" aria-hidden="true">Pilates</span>
</section>

<!-- ═══════════════ LAYOUT ═══════════════════════ -->
<div class="container">
  <div class="sv-layout">

    <!-- SIDEBAR SUBLISTA -->
    <aside class="sv-sidebar sv-reveal">
      <div class="sv-sidebar-title">Servicios</div>

      {% if servicios %}
        <ul class="sv-nav">
          {% for s in servicios %}
            <li class="sv-nav-item">
              <a href="#servicio-{{ s.pk }}">
                <span class="sv-nav-dot"></span>
                <span style="flex:1;">{{ s.name }}</span>
                <span class="sv-nav-num">{{ forloop.counter|stringformat:"02d" }}</span>
              </a>
            </li>
          {% endfor %}
        </ul>
        <div class="mt-4 p-3 rounded-3" style="background:rgba(201,168,76,.08);border:1px dashed var(--sv-gold);">
          <p style="font-family:'DM Sans',sans-serif;font-size:.82rem;color:#7a6a40;margin:0;line-height:1.5;">
            <i class="bi bi-info-circle me-1"></i>
            ¿Tienes dudas sobre qué servicio elegir?
          </p>
          <a href="{% url 'index:contacto_publico' %}"
             style="font-family:'DM Sans',sans-serif;font-size:.82rem;color:var(--sv-gold);font-weight:600;text-decoration:none;">
            Contáctanos → 
          </a>
        </div>
      {% else %}
        <p style="font-family:'DM Sans',sans-serif;font-size:.88rem;color:#9a9ab0;">
          Sin servicios disponibles.
        </p>
      {% endif %}
    </aside>

    <!-- LISTA DE SERVICIOS -->
    <main>
      {% if servicios %}
        {% for s in servicios %}
          <article class="sv-card sv-reveal sv-reveal-d1" id="servicio-{{ s.pk }}">

            <!-- IMAGEN -->
            <div class="sv-card-img">
              {% if s.image %}
                <img src="{{ s.image.url }}" alt="{{ s.name }}">
              {% else %}
                <div class="sv-card-img-fallback">
                  <i class="bi bi-grid-3x3-gap"></i>
                </div>
              {% endif %}
              <span class="sv-card-num" aria-hidden="true">
                {{ forloop.counter|stringformat:"02d" }}
              </span>
            </div>

            <!-- CONTENIDO -->
            <div class="sv-card-body">
              <div class="sv-card-index">Servicio · {{ forloop.counter|stringformat:"02d" }}</div>
              <h2 class="sv-card-title">{{ s.name }}</h2>
              <p class="sv-card-desc">{{ s.description }}</p>
              <div class="sv-card-price">
                ${{ s.price|floatformat:0 }}
                <small>CLP</small>
              </div>
              <a href="{% url 'index:contacto_publico' %}?servicio={{ s.name|urlencode }}"
                 class="sv-card-btn">
                <i class="bi bi-chat-dots"></i> Consultar este servicio
              </a>
            </div>

          </article>
        {% endfor %}

        <!-- CTA FINAL -->
        <div class="sv-cta sv-reveal sv-reveal-d2">
          <div class="row align-items-center g-3" style="position:relative;z-index:1;">
            <div class="col-lg-7">
              <p class="sv-label mb-2" style="color:rgba(10,10,15,.5);">¿No encontraste lo que buscas?</p>
              <h3 class="sv-display mb-2" style="font-size:clamp(1.5rem,3vw,2.2rem);color:var(--sv-ink);">
                Cuéntanos tu objetivo
              </h3>
              <p style="font-family:'DM Sans',sans-serif;font-size:.95rem;color:rgba(10,10,15,.65);margin:0;">
                Podemos adaptar un servicio a tus necesidades específicas.
              </p>
            </div>
            <div class="col-lg-5 text-lg-end">
              <a href="{% url 'index:contacto_publico' %}"
                 style="display:inline-flex;align-items:center;gap:.5rem;
                        padding:.85rem 2rem;border-radius:999px;
                        background:var(--sv-ink);color:#fff;
                        font-family:'DM Sans',sans-serif;font-weight:600;
                        text-decoration:none;font-size:.9rem;
                        transition:all .25s ease;"
                 onmouseenter="this.style.background='#fff';this.style.color='var(--sv-ink)';"
                 onmouseleave="this.style.background='var(--sv-ink)';this.style.color='#fff';">
                <i class="bi bi-envelope"></i> Escribir ahora
              </a>
            </div>
          </div>
        </div>

      {% else %}
        <div class="sv-empty sv-reveal">
          <i class="bi bi-grid fs-1 d-block mb-3" style="color:var(--sv-border);"></i>
          <h4 style="font-family:'Playfair Display',serif;color:var(--sv-ink);">
            Próximamente
          </h4>
          <p style="font-family:'DM Sans',sans-serif;color:#9a9ab0;">
            Estamos preparando nuestros servicios. Vuelve pronto.
          </p>
          <a href="{% url 'index:contacto_publico' %}" class="sv-card-btn mt-3"
             style="margin:0 auto;">
            <i class="bi bi-chat-dots"></i> Consultar
          </a>
        </div>
      {% endif %}
    </main>

  </div>
</div>

<script>
(function(){
  // ── REVEAL ────────────────────────────────────
  const ro = new IntersectionObserver(entries => {
    entries.forEach(e => {
      if(e.isIntersecting){ e.target.classList.add('sv-in'); ro.unobserve(e.target); }
    });
  }, {threshold: 0.1});
  document.querySelectorAll('.sv-reveal').forEach(el => ro.observe(el));

  // ── SIDEBAR ACTIVE LINK ───────────────────────
  const links = document.querySelectorAll('.sv-nav-item a');
  const sections = [...links].map(a => document.querySelector(a.getAttribute('href'))).filter(Boolean);

  const so = new IntersectionObserver(entries => {
    entries.forEach(e => {
      if(e.isIntersecting){
        links.forEach(l => l.classList.remove('active'));
        const active = document.querySelector(`.sv-nav-item a[href="#${e.target.id}"]`);
        if(active) active.classList.add('active');
      }
    });
  }, {threshold: 0.4, rootMargin: '-100px 0px -50% 0px'});
  sections.forEach(s => so.observe(s));

  // ── SMOOTH SCROLL ─────────────────────────────
  links.forEach(a => {
    a.addEventListener('click', e => {
      e.preventDefault();
      const target = document.querySelector(a.getAttribute('href'));
      if(target) target.scrollIntoView({behavior:'smooth', block:'start'});
    });
  });
})();
</script>

{% endblock %}