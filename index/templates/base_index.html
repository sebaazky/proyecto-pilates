{% load static %}
<!DOCTYPE html>
<html lang="es" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Pilates Reforma{% endblock %}</title>

    <!-- Favicon -->
    <link rel="icon" href="{% static 'favicon.ico' %}" />

    <!-- Vendor -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet"/>
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>

    <!-- CSS est√°ticos -->
    <link rel="stylesheet" href="{% static 'css/chatbot.css' %}?v=5" />
    <link rel="stylesheet" href="{% static 'css/site.css' %}?v=41" />
    <link rel="stylesheet" href="{% static 'css/navbar.css' %}?v=52" />

    <!-- ====== ESTILOS NUEVA EST√âTICA (suave, limpio, llamativo) ====== -->
    <style>
      :root{
        --pr-bg: #fffefa;          /* fondo muy claro */
        --pr-surface:#ffffff;
        --pr-soft:#fff9f1;
        --pr-border:#eadfce;

        --pr-ac1:#12b3ff;  /* cian */
        --pr-ac2:#4f8df7;  /* azul */
        --pr-ac3:#48e0c2;  /* turquesa */
        --pr-ac4:#f59e0b;  /* √°mbar */
        --pr-rose:#ff6db3; /* rosa */
        --pr-vio:#8b5cf6;  /* violeta */
      }
      html,body{background:var(--pr-bg);}

      /* Fondo sutil (sin animaci√≥n) */
      body::before{
        content:"";position:fixed;inset:0;z-index:-1;
        background:
          radial-gradient(70vmax 70vmax at -10% -20%, rgba(18,179,255,.05), transparent 60%),
          radial-gradient(70vmax 70vmax at 110% 0%, rgba(139,92,246,.05), transparent 60%),
          radial-gradient(70vmax 70vmax at 50% 120%, rgba(72,224,194,.05), transparent 60%),
          linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.65));
      }

      /* Barra superior arco√≠ris suave (sin movimiento) */
      .hr-accent{
        height:3px;
        background: linear-gradient(90deg,var(--pr-ac1),var(--pr-ac2),var(--pr-ac3),var(--pr-rose),var(--pr-ac4),var(--pr-ac2));
        box-shadow: 0 6px 18px rgba(79,141,247,.18);
      }

      /* Navbar & topbar: glass suave */
      .nav--glass{
        background: rgba(255,255,255,.9);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(234,223,206,.9);
        box-shadow: 0 12px 24px rgba(17,24,39,.06), inset 0 0 0 1px rgba(255,255,255,.6);
      }
      .navbar .nav-link{
        border-radius: 999px; border:1px solid var(--pr-border);
        background: linear-gradient(180deg, #fff, rgba(255,255,255,.8));
        transition: box-shadow .2s ease, transform .15s ease;
      }
      .navbar .nav-link:hover{ transform: translateY(-1px); box-shadow: 0 10px 18px rgba(17,24,39,.08); }
      .navbar .nav-link.active{
        color:#fff!important;border:0;background:linear-gradient(90deg,var(--pr-ac1),var(--pr-ac2));
        box-shadow: 0 12px 24px rgba(79,141,247,.26);
      }

      /* Chips topbar */
      .tb-pill{border-radius:999px;border:1px solid var(--pr-border);background:rgba(255,255,255,.95)}
      .tb-pill:hover{box-shadow:0 10px 20px rgba(17,24,39,.06)}

      /* Botones */
      .btn-gradient{
        background:linear-gradient(90deg,var(--pr-ac1),var(--pr-ac2));
        color:#fff;border:0;box-shadow:0 12px 26px rgba(79,141,247,.26);
      }
      .btn-gradient:hover{filter:brightness(1.03)}
      .btn-outline-secondary{border:1px solid var(--pr-border);background:#fff}

      /* Tarjetas con marco crom√°tico (est√°tico) */
      .card-neo{
        position:relative;border-radius:18px;background:var(--pr-surface);border:1px solid var(--pr-border);
        box-shadow:0 12px 26px rgba(17,24,39,.08);overflow:hidden;
      }
      .card-neo::before{
        content:"";position:absolute;inset:-2px;border-radius:20px;z-index:0;
        background: conic-gradient(from 40deg, rgba(18,179,255,.16), rgba(79,141,247,.12), rgba(72,224,194,.14), rgba(245,158,11,.12), rgba(255,109,179,.12), transparent 90%);
        filter: blur(8px); opacity:.55;
      }
      .card-neo > *{position:relative;z-index:1}

      /* Marcos multicolor para im√°genes (sin animaci√≥n) */
      .color-frame{display:block;padding:2px;border-radius:16px;
        background: conic-gradient(from 0deg,var(--pr-ac1),var(--pr-ac2),var(--pr-ac3),var(--pr-rose),var(--pr-ac4),var(--pr-ac2));
        box-shadow:0 10px 22px rgba(17,24,39,.07);
      }
      .color-frame > img{display:block;width:100%;border-radius:14px}

      /* Encabezados de secci√≥n */
      .sec-head .label{
        display:inline-flex;align-items:center;gap:.5rem;background:var(--pr-soft);border:1px solid var(--pr-border);
        padding:.35rem .7rem;border-radius:999px;font-size:.8rem
      }

      /* HOME SCOPE */
      {% if request.resolver_match.url_name|default:'' == 'index' %}
      .home-scope section{scroll-margin-top:90px}

      /* HERO aura (no modifico hero content) */
      .home-scope .hero-bg{position:relative}
      .home-scope .hero-bg:before{
        content:"";position:absolute;inset:-40px -10px 30px;z-index:-1;
        background:
          radial-gradient(60% 60% at 0% 0%,rgba(18,179,255,.12),transparent 60%),
          radial-gradient(60% 60% at 100% 20%,rgba(79,141,247,.1),transparent 60%);
        filter:blur(8px)
      }

      /* ¬øPOR QU√â ELEGIR? */
      #porque{position:relative}
      #porque:after{content:"";position:absolute;inset:-30px 0 auto 0;height:160px;z-index:-1;
        background:radial-gradient(60% 50% at 50% 0,rgba(18,179,255,.1),transparent 70%);filter:blur(8px)}
      .why-grid{display:grid;gap:1rem;grid-template-columns:repeat(3,1fr)}
      @media(max-width:992px){.why-grid{grid-template-columns:1fr}}
      .why-card{
        border-radius:18px;background:var(--pr-surface);border:1px solid var(--pr-border);padding:1.2rem 1.2rem 1.05rem;
        box-shadow:0 10px 26px rgba(17,24,39,.07);
      }
      .why-ico{width:60px;height:60px;border-radius:14px;background:var(--pr-soft);display:flex;align-items:center;justify-content:center;font-size:1.5rem;border:1px dashed var(--pr-border)}

      /* Pasos */
      .why-steps{display:grid;gap:1rem;grid-template-columns:repeat(3,1fr);margin-top:1rem}
      @media(max-width:992px){.why-steps{grid-template-columns:1fr}}
      .step{border:1px dashed var(--pr-border);border-radius:16px;padding:1rem;background:#fff;box-shadow:0 8px 18px rgba(17,24,39,.05)}
      .badge-num{
        width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--pr-ac1),var(--pr-ac2));
        color:#fff;display:inline-flex;align-items:center;justify-content:center;font-weight:800;margin-right:.6rem;
      }

      /* ===== SOLO PILATES REFORMER (una modalidad) ===== */
      .reformer-wrap{display:grid;grid-template-columns:1.05fr .95fr;gap:1.2rem}
      @media(max-width:992px){.reformer-wrap{grid-template-columns:1fr}}
      .frame-grad{padding:3px;border-radius:1rem;background:linear-gradient(135deg,var(--pr-ac1),var(--pr-ac2),var(--pr-ac3))}
      .frame-grad .img-wrap{border-radius:.9rem;overflow:hidden;position:relative}
      .frame-grad img{width:100%;height:100%;object-fit:cover}

      /* ===== Recorrido visual (mosaico) ===== */
      .mosaic{display:grid;grid-template-columns:2fr 1.2fr 1.2fr;gap:12px}
      .mosaic .tall{grid-row:span 2}
      .mosaic .wide{grid-column:span 2}
      @media(max-width:992px){.mosaic{grid-template-columns:1fr 1fr}}
      @media(max-width:576px){.mosaic{grid-template-columns:1fr}}
      .mosaic a{display:block;border-radius:14px;overflow:hidden}
      .mosaic .color-frame{border-radius:14px}
      .mosaic img{width:100%;height:100%;object-fit:cover;display:block}

      /* ===== Precios (3 opciones, Premium destacado sin animaci√≥n) ===== */
      .pricing-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}
      @media(max-width:992px){.pricing-grid{grid-template-columns:1fr}}
      .price-card{border-radius:20px;border:1px solid var(--pr-border);background:#fff;box-shadow:0 12px 28px rgba(17,24,39,.08);overflow:hidden}
      .price-head{padding:1.15rem 1.35rem;border-bottom:1px solid var(--pr-border);background:linear-gradient(180deg,#fff,rgba(255,255,255,.9))}
      .price-title{margin:0;font-weight:800;letter-spacing:.3px}
      .price-value{font-size:2.1rem;font-weight:900;letter-spacing:.3px;margin:.1rem 0 .4rem;background:linear-gradient(90deg,var(--pr-ac1),var(--pr-ac2),var(--pr-ac3));-webkit-background-clip:text;background-clip:text;color:transparent}
      .price-body{padding:1rem 1.35rem}
      .price-body li{margin:.35rem 0}
      .price-cta{padding:1rem 1.35rem;border-top:1px solid var(--pr-border);background:#fff}

      .price-card.premium{padding:2px;border:0;background:conic-gradient(from 20deg,var(--pr-ac1),var(--pr-ac2),var(--pr-ac3),var(--pr-rose),var(--pr-ac4),var(--pr-ac2))}
      .price-card.premium .inner{border-radius:18px;background:#fff;box-shadow:0 16px 36px rgba(79,141,247,.18)}
      .ribbon{
        position:absolute;top:14px;right:-36px;transform:rotate(35deg);
        background:linear-gradient(90deg,var(--pr-ac1),var(--pr-ac2));color:#fff;font-weight:800;font-size:.75rem;
        padding:.35rem 2.2rem;box-shadow:0 10px 20px rgba(79,141,247,.26);z-index:3;
      }

      /* Reveal suave */
      .lp-reveal{opacity:0;transform:translateY(14px);transition:opacity .45s ease, transform .45s ease}
      .lp-reveal.is-in{opacity:1;transform:none}
      {% endif %}
    </style>
  </head>

  <body class="d-flex flex-column min-vh-100 chat-theme--glass nav-style--dock">
    <!-- CSRF token accesible para JS -->
    <div id="csrf-token" style="display: none">{% csrf_token %}</div>

    <!-- TOP BAR -->
    <div class="tb-aura">
      <div class="container tb-flex">
        <a href="/" class="tb-brand" aria-label="Pilates Reforma">
          <span class="tb-badge"><i class="bi bi-heart-pulse-fill"></i></span>
          <span class="tb-title"><span class="tb-name-1l">Pilates <span>Reforma</span></span></span>
        </a>

        <nav class="tb-chips">
          <a class="tb-pill" href="#mapa" aria-label="Ver ubicaci√≥n"><i class="bi bi-geo-alt-fill"></i><span>Pe√±alol√©n ¬∑ Santiago</span></a>
          <a class="tb-pill" href="tel:+56912345678" aria-label="Llamar"><i class="bi bi-telephone-fill"></i><span>+56 9 1234 5678</span></a>
          <a class="tb-pill" href="mailto:contacto@pilatesreforma.cl" aria-label="Enviar correo"><i class="bi bi-envelope-fill"></i><span>contacto@pilatesreforma.cl</span></a>
        </nav>
      </div>
    </div>

    {% with current=request.resolver_match.url_name|default:"" %}
    <div class="hr-accent"></div>

    <!-- Navbar -->
    <nav id="navbar" class="navbar navbar-expand-lg sticky-top border-0 py-3 nav--glass">
      <div class="container justify-content-center">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavGlass" aria-controls="navbarNavGlass" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse justify-content-center" id="navbarNavGlass">
          <ul class="navbar-nav align-items-center gap-2">
            <li class="nav-item"><a class="nav-link pr-pill fw-semibold px-4 py-2 {% if current == 'index' %}active{% endif %}" href="{% url 'index:index' %}"><i class="bi bi-house-door me-1"></i>Inicio</a></li>
            <li class="nav-item"><a class="nav-link pr-pill fw-semibold px-4 py-2 {% if current == 'nosotros' %}active{% endif %}" href="{% url 'index:nosotros' %}"><i class="bi bi-people-fill me-1"></i>Nosotros</a></li>
            <li class="nav-item"><a class="nav-link pr-pill fw-semibold px-4 py-2 {% if current == 'clases' %}active{% endif %}" href="{% url 'index:clases' %}"><i class="bi bi-grid-3x3-gap me-1"></i>Clases</a></li>
            <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'novedades' %}active{% endif %}" href="{% url 'index:novedades' %}"><i class="bi bi-broadcast me-1"></i> Novedades</a></li>
            <li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'faqs' %}active{% endif %}" href="{% url 'index:faqs' %}"><i class="bi bi-question-circle me-1"></i> FAQs</a></li>
            <li class="nav-item"><a class="nav-link pr-pill fw-semibold px-4 py-2 {% if current == 'contacto_publico' %}active{% endif %}" href="{% url 'index:contacto_publico' %}"><i class="bi bi-chat-dots me-1"></i>Contacto</a></li>
            <li class="nav-item"><a class="nav-link pr-pill fw-semibold px-4 py-2 {% if current == 'login' %}active{% endif %}" href="{% url 'login:login' %}"><i class="bi bi-box-arrow-in-right me-1"></i>Login</a></li>
          </ul>

          <div class="ms-lg-3 mt-3 mt-lg-0">
            <button class="btn btn-outline-secondary d-inline-flex align-items-center" id="themeToggle" type="button" aria-label="Cambiar tema">
              <i id="themeIcon" class="bi bi-moon-stars"></i>
            </button>
          </div>
        </div>
      </div>
    </nav>
    {% endwith %}

    <!-- TRUST BAR -->
    {% if request.resolver_match.url_name|default:'' == 'index' %}
    <div class="lp-trustbar py-2">
      <div class="container d-flex flex-wrap gap-3 justify-content-center small">
        <div class="d-flex align-items-center gap-2"><i class="bi bi-bag-check"></i> Reserva f√°cil</div>
        <div class="d-flex align-items-center gap-2"><i class="bi bi-people"></i> Grupos peque√±os</div>
        <div class="d-flex align-items-center gap-2"><i class="bi bi-award"></i> Certificaciones internacionales</div>
        <div class="d-flex align-items-center gap-2"><i class="bi bi-shield-plus"></i> Medidas higi√©nicas</div>
      </div>
    </div>
    {% endif %}

    <!-- Contenido din√°mico -->
    {% block content %}{% endblock %}

    <!-- ===================== HOME ===================== -->
    {% if request.resolver_match.url_name|default:'' == 'index' %}
    <div class="home-scope">
      <!-- HERO (contenido se inyecta con #hero-replacement; NO CAMBIADO) -->
      <section class="container my-5 hero-bg lp-reveal"></section>

      <!-- ¬øPOR QU√â ELEGIR? -->
      <section id="porque" class="container my-5 lp-reveal">
        <div class="sec-head text-center mb-4">
          <span class="label"><i class="bi bi-stars"></i> Beneficios clave</span>
          <h3 class="fw-bold">¬øPor qu√© elegir <span class="text-gradient">Pilates Reforma</span>?</h3>
          <div class="text-muted">Resultados visibles con t√©cnica segura y acompa√±amiento real.</div>
        </div>

        <div class="why-grid">
          <article class="why-card">
            <div class="why-ico"><i class="bi bi-person-hearts" style="color:var(--pr-ac1)"></i></div>
            <h5 class="fw-bold mb-1">Atenci√≥n personalizada</h5>
            <p class="text-muted mb-2">Clases adaptadas a tu nivel y condici√≥n f√≠sica, con seguimiento constante.</p>
            <span class="small text-muted"><i class="bi bi-patch-check-fill me-1"></i> Planes por nivel</span>
          </article>

          <article class="why-card">
            <div class="why-ico"><i class="bi bi-calendar-week" style="color:var(--pr-ac2)"></i></div>
            <h5 class="fw-bold mb-1">Reserva online</h5>
            <p class="text-muted mb-2">Agenda desde cualquier lugar con nuestra plataforma inteligente.</p>
            <a href="{% url 'index:clases' %}" class="btn btn-gradient btn-sm"><i class="bi bi-calendar2-week me-1"></i> Ver horarios</a>
          </article>

          <article class="why-card">
            <div class="why-ico"><i class="bi bi-bar-chart-line-fill" style="color:#22c55e"></i></div>
            <h5 class="fw-bold mb-1">Resultados visibles</h5>
            <p class="text-muted mb-2">Mejora postura, flexibilidad y fuerza con rutinas efectivas y seguras.</p>
            <span class="small text-muted"><i class="bi bi-heart-pulse me-1"></i> Enfoque en t√©cnica</span>
          </article>
        </div>

        <div class="why-steps">
          <div class="step">
            <div class="d-flex align-items-center mb-2"><span class="badge-num">1</span><strong>Crea tu cuenta</strong></div>
            <div class="text-muted small">Toma menos de un minuto.</div>
          </div>
          <div class="step">
            <div class="d-flex align-items-center mb-2"><span class="badge-num">2</span><strong>Reserva tu clase</strong></div>
            <div class="text-muted small">Selecciona el horario ideal para ti.</div>
          </div>
          <div class="step">
            <div class="d-flex align-items-center mb-2"><span class="badge-num">3</span><strong>Disfruta los resultados</strong></div>
            <div class="text-muted small">M√°s energ√≠a y mejor postura.</div>
          </div>
        </div>
      </section>

      <!-- √öNICA MODALIDAD: PILATES REFORMER -->
      <section id="modalidades" class="container my-5 lp-reveal">
        <div class="sec-head text-center mb-4">
          <span class="label"><i class="bi bi-activity"></i> Modalidad</span>
          <h3 class="fw-bold">Pilates Reformer</h3>
          <div class="text-muted">Precisi√≥n y control con asistencia de resortes. Seguro para todos los niveles.</div>
        </div>

        <div class="reformer-wrap">
          <div class="frame-grad">
            <div class="img-wrap">
              <img loading="lazy" src="https://images.unsplash.com/photo-1605296867304-46d5465a13f1?q=80&w=1600&auto=format&fit=crop" alt="Pilates Reformer">
            </div>
          </div>
          <div class="card-neo p-4">
            <h5 class="fw-bold">Lo que vas a trabajar</h5>
            <ul class="text-muted mb-3">
              <li>Estabilidad del core y alineaci√≥n postural.</li>
              <li>Rango de movimiento controlado y seguro.</li>
              <li>Fortaleza sin impacto articular.</li>
              <li>Progresiones para rehabilitaci√≥n y performance.</li>
            </ul>
            <a href="{% url 'index:clases' %}" class="btn btn-gradient"><i class="bi bi-calendar-check me-1"></i> Reservar clase Reformer</a>
          </div>
        </div>
      </section>

      <!-- RECORRIDO VISUAL (Mosaico con marcos de color) -->
      <section class="container my-5 lp-reveal">
        <div class="sec-head d-flex align-items-center justify-content-between mb-3">
          <div>
            <span class="label"><i class="bi bi-camera"></i> Nuestro estudio</span>
            <h3 class="fw-bold m-0">Recorrido visual</h3>
            <div class="text-muted">As√≠ se ve tu pr√≥xima clase.</div>
          </div>
          <button class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#tourModal">
            <i class="bi bi-image me-1"></i> Ver galer√≠a
          </button>
        </div>

        <div class="mosaic">
          <a class="tall"><span class="color-frame"><img loading="lazy" src="https://images.unsplash.com/photo-1588286840104-8957b019727f?q=80&w=1600&auto=format&fit=crop" alt=""></span></a>
          <a><span class="color-frame"><img loading="lazy" src="https://images.unsplash.com/photo-1599050762458-3cda3b3d6b7a?q=80&w=1600&auto=format&fit=crop" alt=""></span></a>
          <a class="wide"><span class="color-frame"><img loading="lazy" src="https://images.unsplash.com/photo-1571019614242-c5c5dee9f50b?q=80&w=1600&auto=format&fit=crop" alt=""></span></a>
          <a><span class="color-frame"><img loading="lazy" src="https://images.unsplash.com/photo-1546483875-ad9014c88eba?q=80&w=1600&auto=format&fit=crop" alt=""></span></a>
          <a><span class="color-frame"><img loading="lazy" src="https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=1600&auto=format&fit=crop" alt=""></span></a>
        </div>

        <!-- Modal galer√≠a -->
        <div class="modal fade tour-modal" id="tourModal" tabindex="-1" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered modal-xl">
            <div class="modal-content">
              <div class="modal-body p-0">
                <div id="tourCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="2600">
                  <div class="carousel-inner">
                    <div class="carousel-item active"><img loading="lazy" src="https://images.unsplash.com/photo-1588286840104-8957b019727f?q=80&w=1600&auto=format&fit=crop" alt=""></div>
                    <div class="carousel-item"><img loading="lazy" src="https://images.unsplash.com/photo-1599050762458-3cda3b3d6b7a?q=80&w=1600&auto=format&fit=crop" alt=""></div>
                    <div class="carousel-item"><img loading="lazy" src="https://images.unsplash.com/photo-1571019614242-c5c5dee9f50b?q=80&w=1600&auto=format&fit=crop" alt=""></div>
                    <div class="carousel-item"><img loading="lazy" src="https://images.unsplash.com/photo-1605296867304-46d5465a13f1?q=80&w=1600&auto=format&fit=crop" alt=""></div>
                    <div class="carousel-item"><img loading="lazy" src="https://images.unsplash.com/photo-1546483875-ad9014c88eba?q=80&w=1600&auto=format&fit=crop" alt=""></div>
                  </div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#tourCarousel" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span><span class="visually-hidden">Anterior</span></button>
                  <button class="carousel-control-next" type="button" data-bs-target="#tourCarousel" data-bs-slide="next"><span class="carousel-control-next-icon"></span><span class="visually-hidden">Siguiente</span></button>
                </div>
              </div>
              <div class="p-3 text-end"><button class="btn btn-outline-secondary" data-bs-dismiss="modal"><i class="bi bi-x-lg me-1"></i>Cerrar</button></div>
            </div>
          </div>
        </div>
      </section>

      <!-- PLANES Y PRECIOS (3 opciones, Premium destacado) -->
      <section class="container my-5 lp-reveal" id="precios">
        <div class="sec-head text-center mb-4">
          <span class="label"><i class="bi bi-cash-coin"></i> Planes y precios</span>
          <h3 class="fw-bold">Elige tu plan</h3>
          <div class="text-muted">Transparente y simple. Cambia de plan cuando quieras.</div>
        </div>

        <div class="pricing-grid">
          <!-- Esencial -->
          <div class="price-card">
            <div class="price-head">
              <h5 class="price-title">Esencial ¬∑ 4 clases</h5>
              <div class="small text-muted">Ideal para comenzar</div>
            </div>
            <div class="price-body">
              <div class="price-value">$39.900</div>
              <ul class="m-0 ps-3 text-muted">
                <li>4 sesiones/mes en Reformer</li>
                <li>Reserva online flexible</li>
                <li>Vigencia 30 d√≠as</li>
              </ul>
            </div>
            <div class="price-cta">
              <a href="{% url 'index:clases' %}?plan=4" class="btn btn-gradient w-100"><i class="bi bi-bag-plus me-1"></i> Elegir Esencial</a>
            </div>
          </div>

          <!-- Premium -->
          <div class="price-card premium position-relative">
            <span class="ribbon">Premium</span>
            <div class="inner">
              <div class="price-head">
                <h5 class="price-title">Premium ¬∑ Ilimitado</h5>
                <div class="small text-muted">Para darle con todo</div>
              </div>
              <div class="price-body">
                <div class="price-value">$99.900</div>
                <ul class="m-0 ps-3 text-muted">
                  <li>Clases ilimitadas</li>
                  <li>Acceso preferente a horarios</li>
                  <li>Renovaci√≥n mensual</li>
                </ul>
              </div>
              <div class="price-cta">
                <a href="{% url 'index:clases' %}?plan=premium" class="btn btn-gradient w-100"><i class="bi bi-stars me-1"></i> Elegir Premium</a>
              </div>
            </div>
          </div>

          <!-- Avanzado -->
          <div class="price-card">
            <div class="price-head">
              <h5 class="price-title">Avanzado ¬∑ 8 clases</h5>
              <div class="small text-muted">M√°s progreso</div>
            </div>
            <div class="price-body">
              <div class="price-value">$69.900</div>
              <ul class="m-0 ps-3 text-muted">
                <li>8 sesiones/mes en Reformer</li>
                <li>Prioridad en cupos</li>
                <li>Vigencia 30 d√≠as</li>
              </ul>
            </div>
            <div class="price-cta">
              <a href="{% url 'index:clases' %}?plan=8" class="btn btn-gradient w-100"><i class="bi bi-lightning-charge-fill me-1"></i> Elegir Avanzado</a>
            </div>
          </div>
        </div>
      </section>

      <!-- Experiencia Reforma -->
      <section class="container my-5 lp-reveal">
        <div class="sec-head text-center mb-4">
          <span class="label"><i class="bi bi-shield-check"></i> Nuestra forma de trabajar</span>
          <h3 class="fw-bold">Experiencia Reforma</h3>
          <div class="text-muted">M√°s que una clase: acompa√±amiento, t√©cnica y resultados.</div>
        </div>

        <div class="reformer-wrap">
          <div class="card-neo p-4">
            <div class="row g-3">
              <div class="col-4 text-center">
                <div class="fw-bold" style="font-size:1.8rem">4.9/5</div>
                <small class="text-muted">Satisfacci√≥n</small>
              </div>
              <div class="col-4 text-center">
                <div class="fw-bold" style="font-size:1.8rem">12+</div>
                <small class="text-muted">A√±os</small>
              </div>
              <div class="col-4 text-center">
                <div class="fw-bold" style="font-size:1.8rem">1000+</div>
                <small class="text-muted">Alumnos</small>
              </div>
            </div>
            <hr>
            <div class="d-flex align-items-start gap-2">
              <i class="bi bi-patch-check-fill fs-4" style="color:var(--pr-ac1)"></i>
              <div>
                <h6 class="fw-bold mb-1">Garant√≠a t√©cnica</h6>
                <p class="text-muted m-0">Si en tu primera sesi√≥n no sientes un trabajo seguro y guiado, te damos una clase adicional sin costo.</p>
              </div>
            </div>
          </div>

          <div class="card-neo p-4">
            <div class="d-flex align-items-start gap-3 mb-3">
              <div class="why-ico"><i class="bi bi-person-video3" style="color:var(--pr-ac2)"></i></div>
              <div><h6 class="fw-bold mb-1">Correcciones en vivo</h6><p class="text-muted m-0">Feedback permanente para que cada repetici√≥n cuente.</p></div>
            </div>
            <div class="d-flex align-items-start gap-3 mb-3">
              <div class="why-ico"><i class="bi bi-box-seam" style="color:var(--pr-ac3)"></i></div>
              <div><h6 class="fw-bold mb-1">Equipamiento premium</h6><p class="text-muted m-0">Reformers y accesorios de est√°ndar profesional.</p></div>
            </div>
            <div class="d-flex align-items-start gap-3">
              <div class="why-ico"><i class="bi bi-people" style="color:var(--pr-ac4)"></i></div>
              <div><h6 class="fw-bold mb-1">Grupos reducidos</h6><p class="text-muted m-0">Atenci√≥n cercana y ambiente motivador.</p></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Ubicaci√≥n -->
      <section id="mapa" class="container my-5 lp-reveal">
        <div class="p-4 p-md-5 rounded-4 text-white" style="background: linear-gradient(90deg,var(--pr-ac1),var(--pr-ac2)); box-shadow: 0 12px 24px rgba(79,141,247,.25);">
          <div class="row align-items-center">
            <div class="col-12 col-md-8">
              <h4 class="fw-bold mb-2">Estamos en Pe√±alol√©n ¬∑ Santiago</h4>
              <p class="mb-0">Av. Consistorial 2810. Estudio c√≥modo, implementos higienizados y estacionamiento en el edificio.</p>
            </div>
            <div class="col-12 col-md-4 text-md-end mt-3 mt-md-0">
              <a href="https://maps.app.goo.gl/Ytz1CZTw9wGq4Jwh7" class="btn btn-light text-dark fw-semibold">
                <i class="bi bi-geo-alt-fill me-1"></i> Ver mapa
              </a>
            </div>
          </div>
        </div>
      </section>

      <!-- Newsletter -->
      <section class="container my-5 lp-reveal">
        <div class="p-4 p-md-5 rounded-4" style="background: rgba(255,255,255,.92); border:1px solid var(--pr-border); box-shadow:0 10px 22px rgba(17,24,39,.08);">
          <div class="row align-items-center g-3">
            <div class="col-12 col-md-6">
              <h5 class="fw-bold mb-1">Recibe tips de postura y promociones</h5>
              <div class="text-muted">Prometemos enviarte solo cosas √∫tiles ‚úâÔ∏è</div>
            </div>
            <div class="col-12 col-md-6">
              <form class="d-flex gap-2">
                <input type="email" class="form-control" placeholder="tu@email.com" required/>
                <button class="btn btn-gradient" type="button">Suscribirme</button>
              </form>
            </div>
          </div>
        </div>
      </section>
    </div>
    {% endif %}
    <!-- =================== /HOME =================== -->

    <!-- ============== FOOTER ============== -->
    <footer class="footer-neo text-white mt-auto">
      <div class="hr-accent"></div>

      <div class="container py-5">
        <div class="row g-4 align-items-start">
          <div class="col-12 col-lg-4">
            <div class="d-flex align-items-center gap-2 mb-2">
              <img src="https://cdn-icons-png.flaticon.com/512/1048/1048953.png" alt="Logo" width="36" height="36" class="rounded-circle border border-light p-1 logo-badge-bg"/>
              <h5 class="m-0 fw-bold footer-title">Pilates Reforma</h5>
            </div>
            <p class="opacity-75 small mb-3">Clases Mat, Reformer y grupales con instructores certificados en Pe√±alol√©n, Santiago.</p>
            <div class="footer-social d-flex align-items-center gap-2">
              <a class="btn-icon" href="https://wa.me/56912345678" target="_blank" rel="noopener" aria-label="WhatsApp"><i class="bi bi-whatsapp"></i></a>
              <a class="btn-icon" href="https://instagram.com" target="_blank" rel="noopener" aria-label="Instagram"><i class="bi bi-instagram"></i></a>
              <a class="btn-icon" href="https://facebook.com" target="_blank" rel="noopener" aria-label="Facebook"><i class="bi bi-facebook"></i></a>
              <a class="btn-icon" href="https://tiktok.com" target="_blank" rel="noopener" aria-label="TikTok"><i class="bi bi-tiktok"></i></a>
              <a class="btn-icon" href="https://youtube.com" target="_blank" rel="noopener" aria-label="YouTube"><i class="bi bi-youtube"></i></a>
            </div>
          </div>

          <div class="col-6 col-lg-2">
            <h6 class="fw-semibold footer-title">Navegaci√≥n</h6>
            <ul class="list-unstyled small m-0 footer-list">
              <li><a class="text-decoration-none text-white footer-link d-inline-flex align-items-center gap-2" href="{% url 'index:index' %}"><i class="bi bi-house-door"></i>Inicio</a></li>
              <li><a class="text-decoration-none text-white footer-link d-inline-flex align-items-center gap-2" href="{% url 'index:clases' %}"><i class="bi bi-grid-3x3-gap"></i>Clases</a></li>
              <li><a class="text-decoration-none text-white footer-link d-inline-flex align-items-center gap-2" href="{% url 'index:contacto_publico' %}"><i class="bi bi-chat-dots"></i>Contacto</a></li>
              <li><a class="text-decoration-none text-white footer-link d-inline-flex align-items-center gap-2" href="{% url 'login:login' %}"><i class="bi bi-box-arrow-in-right"></i>Login</a></li>
            </ul>
          </div>

          <div class="col-6 col-lg-3">
            <h6 class="fw-semibold footer-title">Contacto</h6>
            <ul class="list-unstyled small m-0 footer-list">
              <li class="mb-1 d-flex align-items-start gap-2"><i class="bi bi-geo-alt mt-1"></i><span>Av. Consistorial 2810, Pe√±alol√©n</span></li>
              <li class="mb-1 d-flex align-items-start gap-2"><i class="bi bi-telephone mt-1"></i><a class="text-white text-decoration-none footer-link" href="tel:+56912345678">+56 9 1234 5678</a></li>
              <li class="d-flex align-items-start gap-2"><i class="bi bi-envelope mt-1"></i><a class="text-white text-decoration-none footer-link" href="mailto:contacto@pilatesreforma.cl">contacto@pilatesreforma.cl</a></li>
            </ul>
          </div>

          <div class="col-12 col-lg-3">
            <h6 class="fw-semibold footer-title">Horarios</h6>
            <ul class="list-unstyled small m-0 opacity-75 footer-list">
              <li class="d-flex align-items-center gap-2"><i class="bi bi-clock"></i>Lun‚ÄìVie: 07:00‚Äì21:00</li>
              <li class="d-flex align-items-center gap-2"><i class="bi bi-clock"></i>S√°bados: 09:00‚Äì14:00</li>
              <li class="d-flex align-items-center gap-2"><i class="bi bi-calendar-x"></i>Domingos y festivos: Cerrado</li>
            </ul>
          </div>
        </div>

        <hr class="footer-divider my-4" />

        <div class="d-flex flex-wrap justify-content-between align-items-center small">
          <div class="opacity-75">¬© <span id="year"></span> Pilates Reforma. Todos los derechos reservados.</div>
          <div class="d-flex gap-3">
            <a class="footer-link text-white text-decoration-none" href="#">T√©rminos</a>
            <a class="footer-link text-white text-decoration-none" href="#">Privacidad</a>
            <a class="footer-link text-white text-decoration-none" href="{% url 'index:contacto_publico' %}">Soporte</a>
          </div>
        </div>
      </div>

      <button type="button" aria-label="Volver arriba" class="btn btn-light border-0 shadow position-fixed btn-to-top" onclick="window.scrollTo({top:0, behavior:'smooth'})">
        <i class="bi bi-arrow-up"></i>
      </button>

      <script>(function(){const y=document.getElementById("year");if(y) y.textContent=new Date().getFullYear();})();</script>
    </footer>
    <!-- ============ /FOOTER ============ -->

    <!-- ===================== CHATBOT ===================== -->
    <button id="chatFab" title="Chatear" aria-label="Abrir chat"><span class="iconify" data-icon="teenyicons:robot-solid"></span></button>
    <div id="chatBox" role="dialog" aria-label="Asistente Pilates">
      <header>
        <div><div class="fw-semibold">Asistente Pilates</div><small class="opacity-75">Estoy para ayudarte ‚ú®</small></div>
        <button class="btn btn-sm btn-light" id="chatClose" aria-label="Cerrar"><i class="bi bi-x"></i></button>
      </header>
      <div id="chatMsgs"></div>
      <form id="chatForm" autocomplete="off">
        <input id="chatInput" type="text" placeholder="Escribe tu mensaje..." />
        <button id="chatSend" type="submit"><i class="bi bi-send"></i> Enviar</button>
      </form>
    </div>

    <!-- Template del HERO (NO MODIFICADO) -->
    <template id="hero-replacement">
      <div class="pr-hero-card">
        <span class="chip small mb-2 d-inline-flex align-items-center gap-1"><i class="bi bi-star-fill text-warning"></i> 4.9/5 por nuestros alumnos</span>
        <h1 class="display-5 fw-bold mt-2">Encuentra tu equilibrio con <span class="grad-text">Pilates Reforma</span></h1>
        <p class="lead text-muted mb-4">Reserva clases <strong>Mat</strong>, <strong>Reformer</strong> y <strong>grupales</strong> con instructores certificados. Dise√±ado para todos los niveles.</p>
        <div class="d-flex flex-wrap gap-2">
          <a href="{% url 'index:clases' %}" class="btn btn-gradient btn-lg"><i class="bi bi-calendar-check me-1"></i> Reservar ahora</a>
          <a href="{% url 'index:contacto_publico' %}" class="btn btn-outline-secondary btn-lg"><i class="bi bi-whatsapp me-1"></i> Hablar con nosotros</a>
        </div>
        <div class="d-flex flex-wrap gap-3 mt-3">
          <span class="chip"><i class="bi bi-shield-check me-1"></i> Instructores certificados</span>
          <span class="chip"><i class="bi bi-clock-history me-1"></i> Reserva en 1 minuto</span>
          <span class="chip"><i class="bi bi-heart-pulse me-1"></i> Postura y bienestar</span>
        </div>
      </div>
    </template>

    <!-- JS -->
    <script>
      (function () {
        const ENDPOINT = "{% url 'index:chat_api' %}";
        const box = document.getElementById("chatBox");
        const fab = document.getElementById("chatFab");
        const closeBtn = document.getElementById("chatClose");
        const msgs = document.getElementById("chatMsgs");
        const form = document.getElementById("chatForm");
        const input = document.getElementById("chatInput");
        const STORAGE_KEY = "pr-chat-history";

        // Escape seguro
        function esc(s){
          return (s || "").replace(/[&<>"']/g, ch => ({
            "&":"&amp;",
            "<":"&lt;",
            ">":"&gt;",
            "\"":"&quot;",
            "'":"&#39;"
          })[ch]);
        }
        function linkify(t){
          const re=/(https?:\/\/[^\s<>"']+)/g;
          return t.replace(re, u => `<a href="${u}" target="_blank" rel="noopener noreferrer">${u}</a>`);
        }
        function toHtml(t){
          return linkify(esc(t).replace(/\n/g,"<br>"));
        }

        function getCSRF(){
          const n=document.querySelector('#csrf-token input[name=csrfmiddlewaretoken]');
          if(n&&n.value)return n.value;
          const m=document.cookie.match(/(^|;)\s*csrftoken=([^;]+)/);
          return m?decodeURIComponent(m[2]):"";
        }
        function saveHistory(){
          try{
            const data=[...msgs.querySelectorAll(".bubble")].map(
              b=>({t:b.classList.contains("me-bubble")?"me":"bot",m:b.innerText})
            );
            localStorage.setItem(STORAGE_KEY,JSON.stringify(data));
          }catch(e){}
        }
        function loadHistory(){
          try{
            const raw=localStorage.getItem(STORAGE_KEY);if(!raw)return;
            JSON.parse(raw).forEach(o=>appendBubble(o.m,o.t==="me"));
            msgs.scrollTop=msgs.scrollHeight;
          }catch(e){}
        }
        function appendBubble(text,isMe){
          const div=document.createElement("div");
          div.className="bubble "+(isMe?"me-bubble":"bot-bubble");
          div.innerHTML=toHtml(text);
          msgs.appendChild(div);
          saveHistory();
        }
        function toggle(open){
          box.style.display=open?"block":"none";
          if(open){setTimeout(()=>input.focus(),100);}
        }
        fab.addEventListener("click",()=>toggle(true));
        closeBtn.addEventListener("click",()=>toggle(false));

        form.addEventListener("submit",async(e)=>{
          e.preventDefault();
          const text=(input.value||"").trim(); if(!text) return;
          appendBubble(text,true); input.value="";

          const wait=document.createElement("div");
          wait.className="bubble bot-bubble"; wait.textContent="‚Ä¶";
          msgs.appendChild(wait); msgs.scrollTop=msgs.scrollHeight;

          try{
            const res=await fetch(ENDPOINT,{
              method:"POST",
              headers:{
                "Content-Type":"application/json",
                "X-CSRFToken":getCSRF()
              },
              body:JSON.stringify({message:text})
            });
            msgs.removeChild(wait);
            if(res.ok){
              const data=await res.json();
              appendBubble(data.reply || "Gracias por tu mensaje.",false);
            }else{
              appendBubble("Lo siento, no pude responder ahora. Intenta m√°s tarde.",false);
            }
          }catch{
            try{msgs.removeChild(wait);}catch{}
            appendBubble("Hubo un problema de conexi√≥n. Intenta nuevamente.",false);
          }
          msgs.scrollTop=msgs.scrollHeight;
        });

        input.addEventListener("keydown",(e)=>{
          if(e.key==="Enter"&&!e.shiftKey){
            e.preventDefault();
            form.requestSubmit();
          }
        });

        loadHistory();
        if(!msgs.children.length){
          appendBubble("¬°Hola! Soy tu asistente de Pilates ü§∏‚Äç‚ôÄÔ∏è\nPreg√∫ntame por horarios, precios, ubicaci√≥n o c√≥mo reservar.",false);
        }
      })();
    </script>

    <!-- Tema / Reveal / Reemplazo de hero -->
    <script>
      (() => {
        // THEME
        const root=document.documentElement,KEY="pr-theme";
        function setIcon(t){const i=document.getElementById("themeIcon");if(!i)return;i.className=t==="dark"?"bi bi-sun":"bi bi-moon-stars";}
        function apply(t){root.setAttribute("data-theme",t);setIcon(t);}
        let saved=null;try{saved=localStorage.getItem(KEY);}catch(e){}
        const initial=saved||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");
        apply(initial);
        const btn=document.getElementById("themeToggle");
        if(btn){
          btn.addEventListener("click",()=>{
            const next=root.getAttribute("data-theme")==="dark"?"light":"dark";
            apply(next);
            try{localStorage.setItem(KEY,next);}catch(e){}
          });
        }

        // REVEAL
        const io=new IntersectionObserver((entries)=>{
          entries.forEach((e)=>e.target.classList.toggle("is-in",e.isIntersecting));
        },{threshold:0.14});
        document.querySelectorAll(".lp-reveal").forEach((el)=>io.observe(el));

        // Reemplazo del hero original (se mantiene tu contenido)
        if ("{{ request.resolver_match.url_name|default:'' }}" === "index") {
          const tpl=document.getElementById("hero-replacement");
          const oldH=[...document.querySelectorAll("h1,h2")].find((h)=>/transforma tu cuerpo con pilates/i.test(h.textContent||""));
          if(tpl&&oldH){
            let card=oldH.closest(".glass, .card, .rounded-4, .rounded-3, .rounded, .p-4, .p-5")||oldH.parentElement;
            if(card){
              card.classList.add("pr-hero-card");
              card.innerHTML=tpl.innerHTML;
              const rootWrap=card.closest("section, header, main, div, .container, .container-fluid")||card.parentElement;
              if(rootWrap) rootWrap.classList.add("pr-hero-root");
            }
          }
        }
      })();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
